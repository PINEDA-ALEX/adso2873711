<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TOP-PNE</title>
    <link rel="stylesheet" href="css/master.css">
    <link rel="stylesheet" href="css/custom.css">
    <style>
        .segundoo {
            position: relative;
            /* 🔥 necesario para contener elementos absolutos */
            overflow: hidden;
            /* 🔒 evita que se salga visualmente */
            background-image: url(images/TOP-PNE/image2.png);
            background-size: 80vh 100vh;
            text-align: center;
            padding: 20px;
            border-radius: 10px;
            display: none;
            width: 100%;
            max-width: 500px;
            max-height: 800px;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-sizing: border-box;
            overflow: hidden;
            display: none;
            


        }

        .logo img {
            width: 300px;
            height: 130px;
            margin-bottom: auto;
        }

        .imgTop {
            background: url(images/TOP-PNE/image\ 1@2x.png) no-repeat center /cover;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;

        }

        .mar img {
            width: 200px;
            height: 200px;
            margin-left: 200px;


        }

        .top img {
            width: 180px;
            height: 158px;
            margin-left: 20px;
        }

        .botonIni {
            background-color: #00000070;
            color: #F6EE00;
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .botonIni:hover {
            box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
            transform: translateY(-2px);
        }

        .botonIni h1 {
            margin: 0;
            font-size: 24px;
        }

        .mostrar {
            display: block;
        }

        .volver {
            background: url(images/TOP-PNE/image\ 3\ \(1\).png) no-repeat center /cover;
            background-color: rgba(32, 32, 32, 0.767);
            height: 40px;
            width: 40px;
            margin-left: -350px;
            border-radius: 30px;
            z-index: 900;

        }

        .volver:hover {
            background: url(images/TOP-PNE/image\ 3\ \(1\).png) no-repeat center /cover;
            transform: translateY(-3px);
        }

        .logodos img {
            width: 250px;
            height: 80px;
            margin-bottom: auto;
            margin-top: -50px;
            margin-left: center;
        }

        .contador {
            background-color: rgba(0, 0, 0, 0.495);
            border: black 2px solid;
            border-radius: 20px;
            width: 90px;
            height: 30px;
            margin-top: 10px;
            margin-left: -300px;
        }

        .contador p {
            color: white;
            font-size: 20px;
            margin-top: 4px;
            margin-left: -2px;
        }

        .puntuacion {
            background-color: rgba(0, 0, 0, 0.495);
            border: black 2px solid;
            border-radius: 20px;
            width: 90px;
            height: 30px;
            margin-top: -35px;
            margin-left: 290px;

        }

        .reiniciar {
            background-color: #00000070;
            color: #F6EE00;
            padding: 10px 20px;
            border: none;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        #maso {
            position: absolute;
            width: 100px;
            /* ajusta el tamaño a lo que necesites */
            height: auto;
            pointer-events: none;
            /* para que no interfiera con clics */
            z-index: 1000;
        }
    </style>
</head>

<body>
    <!-- Añade esto dentro del tag <body>, preferiblemente cerca del principio -->
        <audio id="audioFondo" loop>
            <source src="images/TOP-PNE/sonidoFondo.mp3" type="audio/mpeg">
            Tu navegador no soporta audio.
        </audio>    

    <nav class="boton">
        <a href="index.html">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512">
                <path fill="#ffffff"
                    d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z" />
            </svg>
        </a>
    </nav>
    <main>
        <header>
            <h1>TOP-PNE</h1>
            <h2>JUEGO</h2>
        </header>
        <section>
            <div class="inicio" id="inicio">
                <div class="imgTop">
                    <div class="logo">
                        <img src="images/TOP-PNE/Captura_de_pantalla_2025-03-28_111136-removebg-preview 1.png" alt="">
                    </div>
                    <div class="mar">
                        <img src="images/TOP-PNE/martillo2.png" alt="">
                    </div>
                    <div class="top">
                        <img src="images/TOP-PNE/mole_transparent-removebg-preview 1.png" alt="">
                    </div>
                    <button class="botonIni" id="abrir">
                        <h1>iniciar</h1>
                    </button>
                </div>
            </div>


            <div id="segundo" class="segundoo">
                <img src="images/TOP-PNE/martillo.png" id="maso" alt="maso" class="maso" />
                <div id="topos-container"
                    style="position:absolute; top:0; left:0; width:100%; height:100%; z-index:10;"></div>


                <button class="volver" type="button" aria-label="Volver"></button>
                <div class="logodos">
                    <img src="images/TOP-PNE/logo2.png" alt="">
                </div>
                <div class="contador">
                    <p id="tiempo"></p>



                </div>
                <div class="puntuacion">
                    <p id="marcador">0</p>

                </div>






                <div class="conFin">
                    <p id="fin">
                    </p>
                </div>

            </div>
        </section>
        <script>
            const boton = document.getElementById('abrir');
            const inicioDiv = document.getElementById('inicio');
            const segundoDiv = document.getElementById('segundo');
            const volver = document.querySelector(".volver");
            const maso = document.getElementById("maso");
            const marcador = document.getElementById("marcador");
            const tiempoElemento = document.getElementById("tiempo");
            const finElemento = document.getElementById("fin");
            const toposContainer = document.getElementById('topos-container');
            const sonidoGolpe = new Audio('images/TOP-PNE/golpe3.mp3');

            document.getElementById('audioFondo').volume = 0.2; // 0.0 es mudo, 1.0 es el volumen máximo

            const topoImages = [
                'images/TOP-PNE/topo1.png',
                'images/TOP-PNE/topo2.png',
                'images/TOP-PNE/topo3.png',
            ];

            const huecos = [
                { x: 150, y: 150 },
                { x: 165, y: 300 },
                { x: 300, y: 320 },
                { x: 250, y: 220 },
                { x: 90, y: 235 },
                { x: 30, y: 330 },
                { x: 100, y: 400 },
                { x: 250, y: 400 }
            ];

            let tiempoo = 20;
            let puntuacion = 0;
            let intervaloTiempo;
            let intervaloTopos;
            let juegoActivo = false;
            let toposActivos = [];
            const topoMinimo = 1;
            const puntajeGanador = 16;
            let victoriaLograda = false;

            function iniciarJuego() {
                tiempoo = 20;
                puntuacion = 0;
                marcador.innerText = puntuacion;
                tiempoElemento.innerText = tiempoo;
                finElemento.innerHTML = '';
                juegoActivo = true;
                victoriaLograda = false;
                toposActivos = [];
                maso.style.display = 'block';
                clearInterval(intervaloTiempo);
                clearInterval(intervaloTopos);

                intervaloTiempo = setInterval(() => {
                    tiempoo--;
                    tiempoElemento.innerText = tiempoo;
                    if (tiempoo <= 0) terminarJuego();
                }, 1000);

                intervaloTopos = setInterval(() => {
                    if (juegoActivo) {
                        while (toposActivos.length < topoMinimo) crearTopo();
                        for (let i = 0; i < 2; i++) crearTopo();
                    }
                }, 1000);
            }

            function crearTopo() {
                const hueco = huecos[Math.floor(Math.random() * huecos.length)];
                const img = document.createElement('img');
                img.src = topoImages[Math.floor(Math.random() * topoImages.length)];
                img.style.position = 'absolute';
                img.style.left = hueco.x + 'px';
                img.style.top = hueco.y + 'px';
                img.style.cursor = 'pointer';
                img.style.width = '80px';
                img.style.height = '80px';
                img.classList.add('topo');

                img.addEventListener('click', () => {
                    if (!juegoActivo) return;
                    img.remove();
                    puntuacion++;
                    marcador.innerText = puntuacion;

                    if (puntuacion >= puntajeGanador && !victoriaLograda) {
                        juegoActivo = false;
                        clearInterval(intervaloTiempo);
                        clearInterval(intervaloTopos);
                        limpiarTopos();
                        alert("¡Felicidades!🎉 Has ganado el juego 🏁🏆");
                        location.reload();
                    }
                });

                toposContainer.appendChild(img);
                toposActivos.push(img);

                setTimeout(() => {
                    if (img.parentNode && juegoActivo) {
                        img.remove();
                        toposActivos = toposActivos.filter(t => t !== img);
                    }
                }, 1000);
            }

            function limpiarTopos() {
                toposActivos.forEach(topo => {
                    if (topo.parentNode) topo.remove();
                });
                toposActivos = [];
                maso.style.display = 'none';
            }

            function terminarJuego() {
                juegoActivo = false;
                clearInterval(intervaloTiempo);
                clearInterval(intervaloTopos);
                limpiarTopos();
                alert("¡Reto fallido ☠️, Eres un fracasado! 👎.");
                location.reload();
            }

            boton.addEventListener('click', () => {
    inicioDiv.style.display = 'none';
    segundoDiv.style.display = 'flex';
    document.getElementById('audioFondo').play(); // ⬅️ Esto asegura que suene cuando inicia el juego
    iniciarJuego();
});
            volver.addEventListener('click', () => {
                inicioDiv.style.display = 'flex';
                segundoDiv.style.display = 'none';
                clearInterval(intervaloTiempo);
                clearInterval(intervaloTopos);
                juegoActivo = false;
                limpiarTopos();
            });

            segundoDiv.addEventListener('mousemove', (e) => {
                if (!juegoActivo) return;
                const rect = segundoDiv.getBoundingClientRect();
                let x = e.clientX - rect.left - 50;
                let y = e.clientY - rect.top - 50;
                x = Math.max(0, Math.min(x, segundoDiv.clientWidth - 100));
                y = Math.max(0, Math.min(y, segundoDiv.clientHeight - 100));
                maso.style.left = `${x}px`;
                maso.style.top = `${y}px`;
            });

            document.addEventListener('click', () => {
    if (!maso) return;

    // Cambia a la imagen de golpe
    maso.src = 'images/TOP-PNE/martillo2.png';

    // 🔊 Reproduce el sonido
    sonidoGolpe.currentTime = 0; 
    sonidoGolpe.volume = 1// Reinicia si ya se está reproduciendo
    sonidoGolpe.play();

    // Vuelve a la imagen original después de un pequeño tiempo
    setTimeout(() => {
        maso.src = 'images/TOP-PNE/martillo.png';
    }, 150);
});


        </script>

    </main>
</body>

</html>